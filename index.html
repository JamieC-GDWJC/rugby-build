<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Unity Web Player | Mixtape Rugby</title>

  <!-- CSS for the page -->
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden; /* Disable scrollbars */
      background-color: #00a085;
    }

    /* Unity Canvas */
    #unity-canvas {
      width: 100vw;
      height: 100vh;
      background: url('https://i.imgur.com/MYvbXpq.png') no-repeat top center;
      background-size: contain;
      display: block;
      position: fixed;
      top: 0;
      left: 0;
    }

    /* Portrait mode (default) - canvas fills the screen */
    @media screen and (orientation: portrait) {
      #unity-canvas {
        width: 100vw;  /* Full viewport width */
        height: 100vh; /* Full viewport height */
      }
    }

    /* Landscape mode - canvas with 1:1 aspect ratio */
    @media screen and (orientation: landscape) {
      #unity-canvas {
        width: 100vh;  /* Make width equal to viewport height for 1:1 ratio */
        height: 100vh; /* Full height of viewport */
        left: calc(50vw - 50vh); /* Center the square horizontally */
      }
    }
  </style>

  <!-- JavaScript to handle Unity and input field hiding -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Automatically hide input fields generated by Unity's TMP_InputField on mobile
      document.addEventListener('focusin', function (event) {
        var target = event.target;
        if (target.tagName.toLowerCase() === 'input' || target.tagName.toLowerCase() === 'textarea') {
          // Reposition or hide the input box when focused
          target.style.position = "absolute";
          target.style.bottom = "-999px"; // Move it off-screen
          target.style.opacity = 0;       // Make it transparent
        }
      });

      // Ensure the input fields stay hidden after focus is lost
      document.addEventListener('focusout', function (event) {
        var target = event.target;
        if (target.tagName.toLowerCase() === 'input' || target.tagName.toLowerCase() === 'textarea') {
          target.style.opacity = 0; // Keep hidden after typing
        }
      });

      // Adjust canvas when keyboard is shown on mobile
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        window.addEventListener('resize', function () {
          // Check if the keyboard is likely open
          if (window.innerHeight < window.outerHeight - 100) {
            document.querySelector("#unity-canvas").style.position = 'absolute';
            document.querySelector("#unity-canvas").style.bottom = '200px'; // Adjust canvas height above keyboard
          } else {
            document.querySelector("#unity-canvas").style.position = 'fixed';
            document.querySelector("#unity-canvas").style.bottom = '0';
          }
        });
      }
    });
  </script>

</head>

<body>

<!-- Unity Canvas -->
<canvas id="unity-canvas" tabindex="-1"></canvas>

<script src="Build/006 brotli final.loader.js"></script>

<script>
  // Function to resize the canvas on window resize
  function resizeCanvas() {
    var canvas = document.querySelector("#unity-canvas");

    // Update the canvas size based on the screen orientation
    if (window.innerWidth > window.innerHeight) {
      // Landscape mode: 1:1 aspect ratio (square)
      canvas.style.width = window.innerHeight + 'px';
      canvas.style.height = window.innerHeight + 'px';
      canvas.style.left = (window.innerWidth - window.innerHeight) / 2 + 'px'; // Center horizontally
    } else {
      // Portrait mode: Full screen
      canvas.style.width = window.innerWidth + 'px';
      canvas.style.height = window.innerHeight + 'px';
      canvas.style.left = '0'; // Reset to full width
    }
  }

  // Attach the resize event to update the canvas size when the window changes
  window.addEventListener('resize', resizeCanvas);
  window.addEventListener('orientationchange', resizeCanvas);

  // Trigger initial resize
  resizeCanvas();

  // Mobile device configuration for viewport
  if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
    var meta = document.createElement('meta');
    meta.name = 'viewport';
    meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
    document.getElementsByTagName('head')[0].appendChild(meta);
  }

  // Unity instance creation
  createUnityInstance(document.querySelector("#unity-canvas"), {
    arguments: [],
    dataUrl: "Build/006 brotli final.data.unityweb",
    frameworkUrl: "Build/006 brotli final.framework.js.unityweb",
    codeUrl: "Build/006 brotli final.wasm.unityweb",
    streamingAssetsUrl: "StreamingAssets",
    companyName: "Game Design with Jamie Clarke",
    productName: "Mixtape Rugby",
    productVersion: "0.2.0",
    matchWebGLToCanvasSize: true
  }).then((unityInstance) => {
    window.unityInstance = unityInstance;
  });

  // Function to lock the orientation to portrait if supported
  function lockOrientation() {
    if (screen.orientation && screen.orientation.lock) {
      screen.orientation.lock('portrait').catch(function (error) {
        console.log('Screen orientation lock not supported:', error);
      });
    }
  }

  // Attempt to lock the screen orientation to portrait on load
  lockOrientation();
</script>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-analytics-compat.js"></script>

<script>
  // Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBlTWVT4eLZYEMzxZplxPhhcs7lCHHHWzk",
    authDomain: "rugby-mixtape.firebaseapp.com",
    databaseURL: "https://rugby-mixtape-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "rugby-mixtape",
    storageBucket: "rugby-mixtape.appspot.com",
    messagingSenderId: "497500005186",
    appId: "1:497500005186:web:92277550dd67ad95419edb",
    measurementId: "G-BR78E6SDJZ"
  };

  // Initialize Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const analytics = firebase.analytics(app);
</script>

</body>
</html>
